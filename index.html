<script>
// Данные игрока
let score = parseInt(localStorage.getItem('kbn_score')) || 0;
let perClick = parseInt(localStorage.getItem('kbn_perClick')) || 1;
let energy = parseInt(localStorage.getItem('kbn_energy')) || 1000;

// Переключение экранов
function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    
    const target = document.getElementById(id);
    if (target) target.classList.add('active');

    const btn = document.querySelector(`[onclick="showScreen('${id}')"]`);
    if (btn) btn.classList.add('active');
}

// Клик
function clickCoin() {
    if (energy > 0) {
        score += perClick;
        energy -= 1;
        updateDisplay();
        saveData();
    }
}

// Обновление цифр
function updateDisplay() {
    document.querySelectorAll('#score').forEach(el => el.innerText = score + " V");
    const enText = document.getElementById('energy-text');
    if (enText) enText.innerText = "⚡ " + energy + " / 1000";
    const bar = document.getElementById('energy');
    if (bar) bar.style.width = (energy / 10) + "%";
}

// Сохранение
function saveData() {
    localStorage.setItem('kbn_score', score);
    localStorage.setItem('kbn_perClick', perClick);
    localStorage.setItem('kbn_energy', energy);
}

// Запуск
updateDisplay();
setInterval(() => { 
    if (energy < 1000) { 
        energy += 1; 
        updateDisplay(); 
        saveData(); 
    } 
}, 1500);
</script>
