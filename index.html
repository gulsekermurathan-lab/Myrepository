<script>
// 1. Память нашего штаба
let score = parseInt(localStorage.getItem('kbn_score')) || 0;
let perClick = parseInt(localStorage.getItem('kbn_perClick')) || 1;
let energy = parseInt(localStorage.getItem('kbn_energy')) || 1000;

// 2. Функция переключения экранов (Лидерборд, Магазин)
function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    
    const targetScreen = document.getElementById(id);
    if (targetScreen) targetScreen.classList.add('active');

    const activeBtn = document.querySelector(`[onclick="showScreen('${id}')"]`);
    if (activeBtn) activeBtn.classList.add('active');
}

// 3. Честный клик
function clickCoin() {
    if (energy > 0) {
        score += perClick;
        energy -= 1;
        updateDisplay();
        saveData();
    }
}

// 4. Обновление интерфейса
function updateDisplay() {
    document.querySelectorAll('#score').forEach(el => el.innerText = score + " V");
    document.getElementById('energy-text').innerText = "⚡ " + energy + " / 1000";
    let energyBar = document.getElementById('energy');
    if (energyBar) energyBar.style.width = (energy / 10) + "%";
}

// 5. Сохранение данных
function saveData() {
    localStorage.setItem('kbn_score', score);
    localStorage.setItem('kbn_perClick', perClick);
    localStorage.setItem('kbn_energy', energy);
}

// Запуск при старте
updateDisplay();

// Регенерация энергии в Береке
setInterval(() => { 
    if (energy < 1000) { 
        energy += 1; 
        updateDisplay(); 
        saveData(); 
    } 
}, 1500);
</script>
